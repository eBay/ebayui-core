import{t as D,r as E,b as K,f as b,p as x,g as r,d as L}from"./registry-EgEQwbXk.js";import{_ as $}from"./dynamic-tag-7vXwaVzE.js";import{_ as V}from"./index-HaLoY7FK.js";import{_ as N}from"./render-tag-_0PNNh6Y.js";import"./preserve-attrs-lolIpBRv.js";import{s as f,c as O}from"./index-QozpcpzM.js";import{h as R,a as H}from"./index--8xUDD5P.js";class T extends Marko.Component{get isAutoSelection(){return this.input.listSelection==="auto"}elementScroll(){f(this.getEls("option")[this.state.selectedIndex])}handleChange(e,s){var t;if(this.state.selectedIndex!==e){const a=(t=this.input.options)==null?void 0:t[e];if(a.disabled)return;this.state.selectedIndex=e,this.once("update",()=>{this.emit("change",{index:e,wasClicked:s,selected:[a.value],el:this.getEls("option")[e]})})}}handleClick(e){this.handleChange(e,!0)}handleMouseDown(){this.wasClicked=!0}handleKeyDown(e){R(e,()=>{this.emit("escape")}),H(e,()=>this.handleChange(this._activeDescendant.index,!1))}handleListboxChange(e){const s=parseInt(e.detail.toIndex,10),t=this.getEls("option")[s],a=this.wasClicked;f(t),this.wasClicked&&(this.wasClicked=!1),this.handleChange(s,a)}onCreate(){this.state={selectedIndex:-1}}onInput(e){const{state:s}=this;e.options=e.options||[],s.selectedIndex=Math.max(-1,e.options.findIndex(t=>t.selected))}onMount(){this._setupMakeup()}onUpdate(){this._setupMakeup()}onRender(){typeof window<"u"&&this._cleanupMakeup()}onDestroy(){this._cleanupMakeup()}_setupMakeup(){const{input:e,state:s}=this;if(e.options.length&&!e.disabled){const t=this.getEl("options"),a=this.getEl("options");this._activeDescendant=O(t,a,a,".listbox__option[role=option]",{activeDescendantClassName:"listbox__option--active",autoInit:s.selectedIndex,autoReset:null,autoScroll:!this.isAutoSelection})}}_cleanupMakeup(){this._activeDescendant&&(this._activeDescendant.destroy(),this._activeDescendant=void 0)}}const h="8VNv28AI",i=D(h),X=i;E.r(h,()=>i);const C=T;i._=K(function(p,e,s,t,a,U){const{name:g,class:v,disabled:j,options:l,tabindex:w=0,...y}=p;var u=l[a.selectedIndex];e.be("div",b(x(y),{role:"listbox",class:r(["listbox__options",v]),tabindex:w}),"@options",t,null,4,{pa:["tabindex"],onactiveDescendantChange:s.d("activeDescendantChange",t.isAutoSelection?"handleListboxChange":void 0,!1),onkeydown:s.d("keydown",!t.isAutoSelection&&"handleKeyDown",!1)});{let d=0;for(const n of l||[]){let c=d++;const{value:q,class:I,text:M,selected:z,disabled:_,tabindex:S,description:k,...A}=n,m="@option[]",o=`[${m}]`;e.be("div",b(x(A),{class:r(["listbox__option",I]),role:"option",tabindex:_?-1:S,"aria-disabled":_&&"true","aria-selected":u===n&&"true"}),m,t,null,4,{pa:["class"],onclick:s.d("click",!t.isAutoSelection&&"handleClick",!1,[c]),onmousedown:s.d("mousedown",t.isAutoSelection&&"handleMouseDown",!1)}),e.be("span",{class:"listbox__value"},"0"+o,t,null,1),e.t(M,t),e.ee(),k&&(e.be("span",{class:"listbox__description"},"1"+o,t,null,1),$(e,k,null,null,null,null,s,"2"+o),e.ee()),N(V,{},e,s,"3"+o),e.ee()}}e.ee(),e.be("select",{hidden:"",class:"listbox__native",name:g},"4",t,null,0);{let d=0;for(const n of l||[]){const c=`[${d++}]`;e.e("option",{value:n.value,selected:n===u,class:r(n.class)},"5"+c,t,0,0)}}e.ee()},{t:h},C);i.Component=L(C,i._);export{X as C};
