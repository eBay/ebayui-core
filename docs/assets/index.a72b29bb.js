import{t as m,r as f,a as g,d as C,m as b,c as r,p as x}from"./merge-attrs.9e0d7be9.js";import{_ as v}from"./index.6c3a3a4b.js";import{r as w}from"./render-tag.1a0b986f.js";import"./preserve-attrs.c8bb8439.js";import{s as _,c as y}from"./index.1d7fdad6.js";import{h as I,a as A}from"./index.cfa4da37.js";class S{get isAutoSelection(){return this.input.listSelection==="auto"}elementScroll(){_(this.getEls("option")[this.state.selectedIndex])}handleChange(e,s){if(this.state.selectedIndex!==e){const t=this.input.options[e];if(t.disabled)return;this.state.selectedIndex=e,this.once("update",()=>{this.emit("change",{index:e,wasClicked:s,selected:[t.value],el:this.getEls("option")[e]})})}}handleClick(e){this.handleChange(e,!0)}handleMouseDown(){this.wasClicked=!0}handleKeyDown(e){I(e,()=>{this.emit("escape")}),A(e,()=>this.handleChange(this._activeDescendant.index,!1))}handleListboxChange(e){const s=parseInt(e.detail.toIndex,10),t=this.getEls("option")[s],i=this.wasClicked;_(t),this.wasClicked&&(this.wasClicked=!1),this.handleChange(s,i)}onCreate(){this.state={selectedIndex:-1}}onInput(e){const{state:s}=this;e.options=e.options||[],s.selectedIndex=Math.max(-1,e.options.findIndex(t=>t.selected))}onMount(){this._setupMakeup()}onUpdate(){this._setupMakeup()}onRender(){typeof window<"u"&&this._cleanupMakeup()}onDestroy(){this._cleanupMakeup()}_setupMakeup(){const{input:e,state:s}=this;if(e.options.length&&!e.disabled){const t=this.getEl("options"),i=this.getEl("options");this._activeDescendant=y(t,i,i,".listbox__option[role=option]",{activeDescendantClassName:"listbox__option--active",autoInit:s.selectedIndex,autoReset:null,autoScroll:!this.isAutoSelection})}}_cleanupMakeup(){this._activeDescendant&&(this._activeDescendant.destroy(),this._activeDescendant=void 0)}}const h="8VNv28AI",o=m(h),$=o;var M=["name","grow","borderless","disabled","fluid","invalid","buttonName","options"],D=["value","text","selected","disabled"];f.exports.r(h,()=>o);const k=S;o._=g(function(n,e,s,t,i,E){var l=n.options[i.selectedIndex];l&&l.text,e.be("div",b(x(n,M),{role:"listbox",class:r(["listbox__options",n.class]),tabindex:n.tabindex||0}),"@options",t,null,4,{pa:["tabindex"],onactiveDescendantChange:s.d("activeDescendantChange",t.isAutoSelection&&"handleListboxChange",!1),onkeydown:s.d("keydown",!t.isAutoSelection&&"handleKeyDown",!1)});{let d=0;for(const a of n.options||[]){let c=d++;const p="@option[]",u="[".concat(p,"]");e.be("div",b(x(a,D),{class:r(["listbox__option",a.class]),role:"option",tabindex:a.disabled?-1:a.tabindex,"aria-disabled":a.disabled&&"true","aria-selected":l===a&&"true"}),p,t,null,4,{pa:["class"],onclick:s.d("click",!t.isAutoSelection&&"handleClick",!1,[c]),onmousedown:s.d("mousedown",t.isAutoSelection&&"handleMouseDown",!1)}),e.be("span",{class:"listbox__value"},"0"+u,t,null,1),e.t(a.text,t),e.ee(),w(v,{},e,s,"1"+u),e.ee()}}e.ee(),e.be("select",{hidden:"",class:"listbox__native",name:n.name},"2",t,null,0);{let d=0;for(const a of n.options||[]){const c="[".concat(d++,"]");e.e("option",{value:a.value,selected:a===l,class:r(a.class)},"3"+c,t,0,0)}}e.ee()},{t:h},k);o.Component=C(k,o._);export{$ as C};
//# sourceMappingURL=index.a72b29bb.js.map
