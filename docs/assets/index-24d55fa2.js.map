{"version":3,"file":"index-24d55fa2.js","sources":["../../src/components/ebay-fake-menu-button/component.js","../../src/components/ebay-fake-menu-button/index.marko"],"sourcesContent":["import Expander from \"makeup-expander\";\nimport * as eventUtils from \"../../common/event-utils\";\n\nexport default {\n    handleMenuKeydown({ el, originalEvent, index }) {\n        eventUtils.handleActionKeydown(originalEvent, () => {\n            this.handleMenuSelect(index, originalEvent, el);\n        });\n\n        eventUtils.handleEscapeKeydown(originalEvent, () => {\n            this.expander.expanded = false;\n            this.focus();\n        });\n    },\n\n    focus() {\n        this.getComponent(\"button\").el.focus();\n    },\n\n    handleButtonEscape() {\n        this.expander.expanded = false;\n    },\n\n    handleExpand() {\n        this.emitComponentEvent({ eventType: \"expand\" });\n    },\n\n    handleCollapse() {\n        this.emitComponentEvent({ eventType: \"collapse\" });\n    },\n\n    handleMenuSelect({ el, originalEvent, index }) {\n        this.emitComponentEvent({\n            eventType: \"select\",\n            el,\n            originalEvent,\n            index,\n        });\n    },\n    handleMousedown({ el, originalEvent }) {\n        this.emitComponentEvent({ eventType: \"mousedown\", el, originalEvent });\n    },\n    emitComponentEvent({ eventType, el, originalEvent, index }) {\n        let eventObj = {\n            el,\n            originalEvent,\n            index,\n        };\n        eventObj = Object.fromEntries(\n            Object.entries(eventObj).filter(([, value]) => value !== undefined)\n        );\n        this.emit(`${eventType}`, eventObj);\n    },\n\n    onRender() {\n        if (typeof window !== \"undefined\") {\n            this._cleanupMakeup();\n        }\n    },\n\n    onMount() {\n        this._setupMakeup();\n    },\n\n    onUpdate() {\n        this._setupMakeup();\n    },\n\n    onDestroy() {\n        this._cleanupMakeup();\n    },\n\n    _setupMakeup() {\n        // In expander we set focusManagement to interactive for fake menu\n        // This is related to setting the tabindex=-1 on menu-button div container for fake menu\n        // In Safari and Firefox when clicking on a button/anchor focus is triggered on\n        // the closest element with tabindex=-1 if there are any above it.\n        // This would cause the menu to close before events are fired\n\n        this.expander = new Expander(this.el, {\n            hostSelector: \".fake-menu-button__button\",\n            contentSelector: \".fake-menu-button__menu\",\n            focusManagement: \"interactive\",\n            expandOnClick: true,\n            autoCollapse: true,\n            alwaysDoFocusManagement: true,\n        });\n    },\n\n    _cleanupMakeup() {\n        if (this.expander) {\n            this.expander.destroy();\n        }\n    },\n};\n","import { processHtmlAttributes } from \"../../common/html-attributes\"\nimport IconButton from '<ebay-icon-button>'\nimport Button from '<ebay-button>'\n\nstatic var ignoredAttributes = [\n    \"class\",\n    \"style\",\n    \"type\",\n    \"text\",\n    \"icon\",\n    \"a11yText\",\n    \"noToggleIcon\",\n    \"expanded\",\n    \"reverse\",\n    \"fixWidth\",\n    \"borderless\",\n    \"size\",\n    \"priority\",\n    \"iconTag\",\n    \"disabled\",\n    \"variant\",\n    \"items\",\n    \"label\",\n    \"textAlign\",\n    \"transparent\"\n];\n\n$ {\n    var labelId = input.prefixId && component.getElId(\"label\");\n    var isOverflowVariant = input.variant === \"overflow\";\n    var isFormVariant = input.variant === \"form\";\n    var isButtonVariant = true;\n    if (input.borderless) {\n        isOverflowVariant = false;\n    }\n    var priority = null;\n    var prefix = 'expand-btn'\n    var variant;\n    var isIconVariant = input.variant === 'icon' || isOverflowVariant;\n\n    var tagName = Button;\n    if (isFormVariant) {\n        prefix = 'btn';\n        variant = 'form';\n    } else if (isIconVariant) {\n        tagName = IconButton;\n        isButtonVariant = false;\n    } else {\n        priority = input.priority\n        prefix = 'btn';\n    }\n}\n<span\n    ...processHtmlAttributes(input, ignoredAttributes)\n    class=[\"fake-menu-button\", input.class]\n    style=input.style\n    onExpander-expand(\"handleExpand\")\n    onExpander-collapse(\"handleCollapse\")\n    onMousedown(\"handleMousedown\")>\n    <${tagName}\n        class=[\n            `fake-menu-button__button`\n        ]\n        size=input.size\n        borderless=input.borderless\n        priority=priority\n        variant=variant\n        transparent=(isIconVariant && input.transparent)\n        icon-only=(!input.text && !input.icon && !isOverflowVariant)\n        aria-expanded=\"false\"\n        aria-label=input.a11yText\n        disabled=input.disabled\n        no-toggle-icon=input.noToggleIcon\n        on-escape(\"handleButtonEscape\")\n        key=\"button\">\n        <if(isOverflowVariant)>\n            <ebay-overflow-vertical-24-icon/>\n        </if>\n        <else>\n            <span class=[\n                `${prefix}__cell`,\n                input.label && \"menu-button__control--custom-label\",\n                input.textAlign === \"center\" && \"expand-btn__cell--center\"\n            ]>\n                <if(input.label)>\n                    <${input.label.renderBody}/>\n                </if>\n                <else>\n                    <if(input.icon)>\n                        <${input.icon}/>\n                    </if>\n                    <if(input.text)>\n                        <span>${input.text}</span>\n                    </if>\n                </else>\n                <if(isButtonVariant && !input.noToggleIcon)>\n                    <ebay-chevron-down-12-icon/>\n                </if>\n            </span>\n        </else>\n    </>\n    <ebay-fake-menu\n        class-prefix=\"fake-menu-button\"\n        type=input.type\n        reverse=(isOverflowVariant ? !input.reverse : input.reverse)\n        fix-width=input.fixWidth\n        tabindex=-1\n        on-keydown(\"handleMenuKeydown\")\n        on-select(\"handleMenuSelect\")\n        key=\"content\">\n        <for|item, index| of=(input.items || [])>\n            <@item ...item/>\n        </for>\n    </ebay-fake-menu>\n</span>\n"],"names":["_marko_component","el","originalEvent","index","eventUtils.handleActionKeydown","eventUtils.handleEscapeKeydown","eventType","eventObj","value","Expander","ignoredAttributes","_marko_registerComponent","_marko_componentType","_marko_template","_marko_component2","_","_marko_renderer","input","out","_componentDef","_component","state","$global","prefixId","getElId","isOverflowVariant","variant","isFormVariant","isButtonVariant","borderless","priority","prefix","isIconVariant","tagName","Button","IconButton","be","_marko_merge_attrs","processHtmlAttributes","_marko_class_merge","class","_marko_style_merge","style","d","_marko_tag","size","transparent","text","icon","a11yText","disabled","noToggleIcon","_ebayOverflowVertical24Icon","concat","label","textAlign","_marko_dynamic_tag","renderBody","t","ee","_ebayChevronDown12Icon","_items","item","items","push","_objectSpread","Symbol","iterator","_marko_self_iterator","_ebayFakeMenu","type","reverse","fixWidth","Component","_marko_defineComponent"],"mappings":"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"}