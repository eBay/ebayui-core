import{t as x,r as f,_ as g,g as u,p as b,h,a as C}from"./merge-attrs-f99eec0a.js";import{_ as v}from"./dynamic-tag-c0238d78.js";import{_ as w}from"./index-7c38a6fb.js";import{_ as y}from"./render-tag-73fdbff3.js";import"./preserve-attrs-ebf43362.js";import{s as m,c as I}from"./index-d7324991.js";import{h as A,a as S}from"./index-ad737ebd.js";class M{get isAutoSelection(){return this.input.listSelection==="auto"}elementScroll(){m(this.getEls("option")[this.state.selectedIndex])}handleChange(e,s){if(this.state.selectedIndex!==e){const t=this.input.options[e];if(t.disabled)return;this.state.selectedIndex=e,this.once("update",()=>{this.emit("change",{index:e,wasClicked:s,selected:[t.value],el:this.getEls("option")[e]})})}}handleClick(e){this.handleChange(e,!0)}handleMouseDown(){this.wasClicked=!0}handleKeyDown(e){A(e,()=>{this.emit("escape")}),S(e,()=>this.handleChange(this._activeDescendant.index,!1))}handleListboxChange(e){const s=parseInt(e.detail.toIndex,10),t=this.getEls("option")[s],n=this.wasClicked;m(t),this.wasClicked&&(this.wasClicked=!1),this.handleChange(s,n)}onCreate(){this.state={selectedIndex:-1}}onInput(e){const{state:s}=this;e.options=e.options||[],s.selectedIndex=Math.max(-1,e.options.findIndex(t=>t.selected))}onMount(){this._setupMakeup()}onUpdate(){this._setupMakeup()}onRender(){typeof window<"u"&&this._cleanupMakeup()}onDestroy(){this._cleanupMakeup()}_setupMakeup(){const{input:e,state:s}=this;if(e.options.length&&!e.disabled){const t=this.getEl("options"),n=this.getEl("options");this._activeDescendant=I(t,n,n,".listbox__option[role=option]",{activeDescendantClassName:"listbox__option--active",autoInit:s.selectedIndex,autoReset:null,autoScroll:!this.isAutoSelection})}}_cleanupMakeup(){this._activeDescendant&&(this._activeDescendant.destroy(),this._activeDescendant=void 0)}}const p="8VNv28AI",o=x(p),T=o;var D=["name","grow","borderless","disabled","fluid","invalid","buttonName","options"],E=["value","text","selected","disabled","description"];f.r(p,()=>o);const k=M;o._=g(function(i,e,s,t,n,K){var l=i.options[n.selectedIndex];l&&l.text,e.be("div",u(b(i,D),{role:"listbox",class:h(["listbox__options",i.class]),tabindex:i.tabindex||0}),"@options",t,null,4,{pa:["tabindex"],onactiveDescendantChange:s.d("activeDescendantChange",t.isAutoSelection&&"handleListboxChange",!1),onkeydown:s.d("keydown",!t.isAutoSelection&&"handleKeyDown",!1)});{let c=0;for(const a of i.options||[]){let r=c++;const _="@option[]",d="[".concat(_,"]");e.be("div",u(b(a,E),{class:h(["listbox__option",a.class]),role:"option",tabindex:a.disabled?-1:a.tabindex,"aria-disabled":a.disabled&&"true","aria-selected":l===a&&"true"}),_,t,null,4,{pa:["class"],onclick:s.d("click",!t.isAutoSelection&&"handleClick",!1,[r]),onmousedown:s.d("mousedown",t.isAutoSelection&&"handleMouseDown",!1)}),e.be("span",{class:"listbox__value"},"0"+d,t,null,1),e.t(a.text,t),e.ee(),a.description&&(e.be("span",{class:"listbox__description"},"1"+d,t,null,1),v(e,a.description,null,null,null,null,s,"2"+d),e.ee()),y(w,{},e,s,"3"+d),e.ee()}}e.ee(),e.be("select",{hidden:"",class:"listbox__native",name:i.name},"4",t,null,0);{let c=0;for(const a of i.options||[]){const r="[".concat(c++,"]");e.e("option",{value:a.value,selected:a===l,class:h(a.class)},"5"+r,t,0,0)}}e.ee()},{t:p},k);o.Component=C(k,o._);export{T as C};
//# sourceMappingURL=index-5af18010.js.map
