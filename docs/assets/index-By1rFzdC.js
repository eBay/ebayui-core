import{t as re,r as ne,b as he,e as Z,c as de}from"./registry-CyswyZw5.js";import{g as fe,l as te}from"./index-CD9SHNZJ.js";import{_ as oe,a as be}from"./index-DkM5y-eZ.js";import{_ as v}from"./render-tag-CLyPs9qZ.js";import{_ as N}from"./index-D57sw9Ri.js";import{_ as B}from"./of-fallback-C2gEBeKK.js";function ee(i){i=te(i);const s=fe(i).w,t=new Intl.DateTimeFormat(i,{weekday:"short"}),a=new Date(2022,9,2+s),o=[...Array(7)].map(()=>{const d=t.format(a);return a.setDate(a.getDate()+1),d});return{firstDayOfWeek:s,weekdayLabels:o}}function $(i){if(!i)return;if(/^\d\d\d\d-\d\d-\d\d$/g.test(i))return i;const e=f(new Date(i));return/^\d\d\d\d-\d\d-\d\d$/g.test(e)?e:void 0}function f(i){return i.toISOString().slice(0,10)}function ce(i){return i.toLocaleDateString("en-CA")}function D(i){return new Date(i)}function E(i,e){const s=D(i);return s.setUTCDate(s.getUTCDate()+e),f(s)}const ge={ArrowRight:1,ArrowLeft:-1,ArrowDown:7,ArrowUp:-7};class Se extends Marko.Component{onCreate(e){this.locale=e.locale;const{firstDayOfWeek:s,weekdayLabels:t}=ee(e.locale),a=ce(new Date);this.state={focusISO:null,baseISO:a,tabindexISO:a,todayISO:a,offset:0,firstDayOfWeek:s,weekdayLabels:t,rangeStart:null,rangeEnd:null,disableBefore:null,disableAfter:null,disableWeekdays:[],disableList:[]}}onInput(e){var s;if(e.locale!==this.locale){this.locale=e.locale;const{firstDayOfWeek:t,weekdayLabels:a}=ee(e.locale);this.state.firstDayOfWeek=t,this.state.weekdayLabels=a}if(e.todayISO){const t=f(new Date(e.todayISO));this.state.todayISO=t,this.state.baseISO=t,this.state.tabindexISO=t}if(e.selected){const t=Array.isArray(e.selected)?e.selected:[e.selected],a=this.getFirstVisibleISO(),o=this.getLastVisibleISO(e);t.find(c=>c>=a&&c<=o)===void 0&&(this.state.baseISO=this.state.tabindexISO=t[0],this.state.offset=0)}if(this.calculateRangeDisplay(e),this.state.disableBefore=$(e.disableBefore),this.state.disableAfter=$(e.disableAfter),this.state.disableWeekdays=e.disableWeekdays??[],this.state.disableList=((s=e.disableList)==null?void 0:s.map($))??[],this.isDisabled(this.state.tabindexISO)){const t=this.getFirstActiveISO(e);t?this.state.tabindexISO=t:this.state.disableBefore&&this.state.tabindexISO<this.state.disableBefore?(this.state.baseISO=this.state.disableBefore,this.state.offset=0,this.state.tabindexISO=this.getFirstActiveISO(e)??this.state.disableBefore):this.state.disableAfter&&this.state.tabindexISO>this.state.disableAfter&&(this.state.baseISO=this.state.disableAfter,this.state.offset=0,this.state.tabindexISO=this.getFirstActiveISO(e)??this.state.disableAfter)}for(;this.state.disableAfter&&this.getMonthDate(this.state.offset+(e.numMonths||1)-1).toISOString()>this.state.disableAfter;)this.state.offset--}isDisabled(e){return this.state.disableBefore&&e<this.state.disableBefore||this.state.disableAfter&&e>this.state.disableAfter||this.state.disableWeekdays.includes(D(e).getUTCDay())||this.state.disableList.includes(e)}onDaySelect(e){this.emit("select",{iso:e})}onDayFocus(e){this.state.focusISO=this.state.tabindexISO=e,this.calculateRangeDisplay()}onDayBlur(){this.state.focusISO=null,this.calculateRangeDisplay()}onKeyDown(e){const s=ge[e.key];if(s){e.preventDefault();let t=7,a=this.state.tabindexISO;do a=E(a,s);while(t-- >0&&this.isDisabled(a));if(t>0){const o=this.getFirstVisibleISO(),d=this.getLastVisibleISO();a<o?this.input.navigable?this.prevMonth():a=o:a>d&&(this.input.navigable?this.nextMonth():a=d),this.setTabindexAndFocus(a),this.emit("focus",{iso:this.state.tabindexISO})}}else switch(e.key){case"PageUp":this.prevMonth(!0);break;case"PageDown":this.nextMonth(!0);break;case"Home":{const t=this.getFirstActiveISO();t&&(this.setTabindexAndFocus(t),this.emit("focus",{iso:this.state.tabindexISO}));break}case"End":{const t=this.getLastActiveISO();t&&(this.setTabindexAndFocus(t),this.emit("focus",{iso:this.state.tabindexISO}));break}}}getMonthDate(e){const s=D(this.state.baseISO);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+e))}getFirstVisibleISO(){return f(this.getMonthDate(this.state.offset))}getLastVisibleISO(e=this.input){const s=D(this.state.baseISO);return f(new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+this.state.offset+(e.numMonths||1),0)))}getFirstActiveISO(e=this.input){let s=this.getFirstVisibleISO();const t=this.getLastVisibleISO(e);for(;s<=t&&this.isDisabled(s);)s=E(s,1);return s>t?null:s}getLastActiveISO(e=this.input){let s=this.getLastVisibleISO(e);const t=this.getFirstVisibleISO();for(;s>=t&&this.isDisabled(s);)s=E(s,-1);return s<t?null:s}monthTitle(e){return new Intl.DateTimeFormat(te(this.input.locale),{month:"long",year:"numeric"}).format(new Date(e.getUTCFullYear(),e.getUTCMonth()))}prevMonth(e){if(this.state.disableBefore&&this.getFirstVisibleISO()<=this.state.disableBefore)return!1;this.state.offset--;let s=this.state.tabindexISO;const t=this.getLastActiveISO();return t&&this.state.tabindexISO>t&&(s=this.state.tabindexISO=t),e&&this.setTabindexAndFocus(s),this.emit("month-change",{iso:f(this.getMonthDate(this.state.offset))}),!0}nextMonth(e){if(this.state.disableAfter&&this.getLastVisibleISO()>=this.state.disableAfter)return!1;this.state.offset++;let s=this.state.tabindexISO;const t=this.getFirstActiveISO();return t&&this.state.tabindexISO<t&&(s=this.state.tabindexISO=t),e&&this.setTabindexAndFocus(s),this.emit("month-change",{iso:f(this.getMonthDate(this.state.offset+(this.input.numMonths||1)))}),!0}setTabindexAndFocus(e){this.state.tabindexISO=e,setTimeout(()=>{var s;return(s=this.getEl(e))==null?void 0:s.focus()})}calculateRangeDisplay(e=this.input){if(e.selected&&e.range){let s,t;Array.isArray(e.selected)?[s,t]=e.selected:this.state.focusISO&&(s=e.selected,t=this.state.focusISO),s&&t?s<t?(this.state.rangeStart=s,this.state.rangeEnd=t):(this.state.rangeStart=t,this.state.rangeEnd=s):this.state.rangeStart=this.state.rangeEnd=null}else this.state.rangeStart=this.state.rangeEnd=null}isInRange(e){return!(!this.state.rangeStart||!this.state.rangeEnd||e<this.state.rangeStart||e>this.state.rangeEnd)}}const W="LySjvpyj",k=re(W);ne.r(W,()=>k);const se=Se;k._=he(function(i,e,s,t,a,o){const{numMonths:d=1,getA11yShowMonthText:c=b=>`Show ${b}`,a11ySelectedText:Y="selected",a11yRangeStartText:R="start of range",a11yInRangeText:j="in range",a11yRangeEndText:P="end of range",a11yTodayText:K="today",a11yDisabledText:z="inactive",a11ySeparator:H=" - ",navigable:ae,selected:I,interactive:ie,linkBuilder:p}=i;var q=[...Array(d)].map((b,r)=>t.getMonthDate(a.offset+r));if(e.be("div",{class:"calendar"},"0",t,null,1),ae){e.be("div",{class:"calendar__header"},"1",t,null,1),e.be("div",{class:"calendar__header--inner"},"2",t,null,1);{v(N,{transparent:!0,size:"small",disabled:a.disableBefore&&t.getFirstVisibleISO()<=a.disableBefore,ariaLabel:c(t.monthTitle(t.getMonthDate(a.offset-1))),renderBody:r=>{v(oe,{},r,s,"4")}},e,s,"3",[["click","prevMonth",!1,[!1]]]);let b=0;for(const r of B(q)){const h=`[${b++}]`;e.be("h3",null,"5"+h,t,null,0),e.t(t.monthTitle(r),t),e.ee()}v(N,{transparent:!0,size:"small",disabled:a.disableAfter&&t.getLastVisibleISO()>=a.disableAfter,ariaLabel:c(t.monthTitle(t.getMonthDate(a.offset+d))),renderBody:r=>{v(be,{},r,s,"7")}},e,s,"6",[["click","nextMonth",!1,[!1]]])}e.ee(),e.ee()}e.be("div",{class:"calendar__body"},"8",t,null,1);{let b=0;for(const r of B(q)){const h=`[${b++}]`;e.be("div",{class:"calendar__month"},"9"+h,t,null,1),e.be("table",null,"10"+h,t,null,0,{onkeydown:s.d("keydown","onKeyDown",!1)}),e.be("caption",null,"11"+h,t,null,0),e.t(t.monthTitle(r),t),e.ee(),e.be("thead",null,"12"+h,t,null,0),e.be("tr",null,"13"+h,t,null,0);{let M=0;for(const g of B(a.weekdayLabels)){const S=`[${M+++h}]`;e.be("th",null,"14"+S,t,null,0),e.t(g,t),e.ee()}}e.ee(),e.ee(),e.be("tbody",null,"15"+h,t,null,0);var O=(r.getUTCDay()-a.firstDayOfWeek+7)%7,G=r.getUTCFullYear(),J=r.getUTCMonth(),w=new Date(G,J+1,0).getDate();for(let M=(Math.floor((O+w)/7)-0)/1,g=0;g<=M;g++){const S=0+g*1,V=`[${S+h}]`;e.be("tr",null,"16"+V,t,null,0);var y=S*7-O+1,x=y+6;S===0&&O!==0?(e.e("td",{colspan:O},"17"+V,t,0,0),y=1):x>w&&(x=w);for(let le=(x-y)/1,_=0;_<=le;_++){const u=y+_*1,C=`[${u+V}]`;var l=f(new Date(Date.UTC(G,J,u))),T=l===a.todayISO,m=Array.isArray(I)?I.some(U=>U===l):I&&I===l,F=l===a.rangeStart,Q=t.isInRange(l),L=l===a.rangeEnd,A=t.isDisabled(l),n=[""];if(Y&&m&&n.push(Y),R&&F&&n.push(R),j&&!F&&!L&&Q&&n.push(j),P&&L&&n.push(P),e.be("td",{class:Z({"calendar__cell--selected":m,"calendar__range--start":F,calendar__range:Q,"calendar__range--end":L})},"18"+C,t,null,1),ie)e.be("button",{disabled:A,"aria-label":n.length>1&&`${u}${n.join(H)}`,tabindex:a.tabindexISO!==l&&-1,"aria-current":T&&"date","aria-pressed":m&&"true"},`@${l}`,t,null,0,{onclick:s.d("click","onDaySelect",!1,[l]),onfocus:s.d("focus","onDayFocus",!1,[l]),onmouseover:s.d("mouseover","onDayFocus",!1,[l]),onblur:s.d("blur","onDayBlur",!1),onmouseout:s.d("mouseout","onDayBlur",!1)}),e.t(u,t),e.ee();else{K&&T&&n.push(K),z&&A&&n.push(z);var X=!A&&p&&p(l);const U=X?"a":"span";e.be(U,{class:Z({"calendar__cell--disabled":A,"calendar__cell--current":T}),href:X},"19"+C,t,null,0),e.t(u,t),n.length>1&&(e.be("span",{class:"clipped"},"20"+C,t,null,1),e.t(n.join(H),t),e.ee()),e.ee()}e.ee()}e.ee()}e.ee(),e.ee(),e.ee()}}e.ee(),e.ee()},{t:W},se);k.Component=de(se,k._);export{k as _,$ as d,f as t};
