import{t as le,r as re,b as ne,f as X,d as he}from"./registry-DcejNBCz.js";import{_ as de,a as fe}from"./index-cOBakdIG.js";import{_ as k}from"./render-tag-BBOJ9dEX.js";import{_ as Z}from"./index-GwxNDCaO.js";function oe(i){const e=new Intl.Locale(i);return e.weekInfo?e.weekInfo.firstDay:0}function ee(i){const e=oe(i),s=new Intl.DateTimeFormat(i,{weekday:"short"}),t=new Date(2022,9,2+e),a=[...Array(7)].map(()=>{const f=s.format(t);return t.setDate(t.getDate()+1),f});return{firstDayOfWeek:e,weekdayLabels:a}}function B(i){if(!i)return;if(/^\d\d\d\d-\d\d-\d\d$/g.test(i))return i;const e=d(new Date(i));return/^\d\d\d\d-\d\d-\d\d$/g.test(e)?e:void 0}function d(i){return i.toISOString().slice(0,10)}function D(i){return new Date(i)}function $(i,e){const s=D(i);return s.setUTCDate(s.getUTCDate()+e),d(s)}function W(i){const e=typeof navigator<"u"?navigator.language:"en-US";return i||e}const be={ArrowRight:1,ArrowLeft:-1,ArrowDown:7,ArrowUp:-7};class ce extends Marko.Component{onCreate(e){const{firstDayOfWeek:s,weekdayLabels:t}=ee(W(e.locale)),a=d(new Date);this.state={focusISO:null,baseISO:a,tabindexISO:a,todayISO:a,offset:0,firstDayOfWeek:s,weekdayLabels:t,rangeStart:null,rangeEnd:null,disableBefore:null,disableAfter:null,disableWeekdays:[],disableList:[]}}onMount(){const{firstDayOfWeek:e}=ee(W(this.input.locale));this.state.firstDayOfWeek=e}onInput(e){var s;if(e.selected){const t=Array.isArray(e.selected)?e.selected:[e.selected],a=this.getFirstVisibleISO(),f=this.getLastVisibleISO(e);t.find(c=>c>=a&&c<=f)===void 0&&(this.state.baseISO=this.state.tabindexISO=t[0],this.state.offset=0)}if(this.calculateRangeDisplay(e),this.state.disableBefore=B(e.disableBefore),this.state.disableAfter=B(e.disableAfter),this.state.disableWeekdays=e.disableWeekdays??[],this.state.disableList=((s=e.disableList)==null?void 0:s.map(B))??[],this.isDisabled(this.state.tabindexISO)){const t=this.getFirstActiveISO(e);t?this.state.tabindexISO=t:this.state.disableBefore&&this.state.tabindexISO<this.state.disableBefore?(this.state.baseISO=this.state.disableBefore,this.state.offset=0,this.state.tabindexISO=this.getFirstActiveISO(e)??this.state.disableBefore):this.state.disableAfter&&this.state.tabindexISO>this.state.disableAfter&&(this.state.baseISO=this.state.disableAfter,this.state.offset=0,this.state.tabindexISO=this.getFirstActiveISO(e)??this.state.disableAfter)}for(;this.state.disableAfter&&this.getMonthDate(this.state.offset+(e.numMonths||1)-1).toISOString()>this.state.disableAfter;)this.state.offset--}isDisabled(e){return this.state.disableBefore&&e<this.state.disableBefore||this.state.disableAfter&&e>this.state.disableAfter||this.state.disableWeekdays.includes(D(e).getUTCDay())||this.state.disableList.includes(e)}onDaySelect(e){this.emit("select",{iso:e})}onDayFocus(e){this.state.focusISO=this.state.tabindexISO=e,this.calculateRangeDisplay()}onDayBlur(){this.state.focusISO=null,this.calculateRangeDisplay()}onKeyDown(e){const s=be[e.key];if(s){e.preventDefault();let t=7,a=this.state.tabindexISO;do a=$(a,s);while(t-- >0&&this.isDisabled(a));if(t>0){const f=this.getFirstVisibleISO(),o=this.getLastVisibleISO();a<f?this.input.navigable?this.prevMonth():a=f:a>o&&(this.input.navigable?this.nextMonth():a=o),this.setTabindexAndFocus(a),this.emit("focus",{iso:this.state.tabindexISO})}}else switch(e.key){case"PageUp":this.prevMonth(!0);break;case"PageDown":this.nextMonth(!0);break;case"Home":{const t=this.getFirstActiveISO();t&&(this.setTabindexAndFocus(t),this.emit("focus",{iso:this.state.tabindexISO}));break}case"End":{const t=this.getLastActiveISO();t&&(this.setTabindexAndFocus(t),this.emit("focus",{iso:this.state.tabindexISO}));break}}}getMonthDate(e){const s=D(this.state.baseISO);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+e))}getFirstVisibleISO(){return d(this.getMonthDate(this.state.offset))}getLastVisibleISO(e=this.input){const s=D(this.state.baseISO);return d(new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+this.state.offset+(e.numMonths||1),0)))}getFirstActiveISO(e=this.input){let s=this.getFirstVisibleISO();const t=this.getLastVisibleISO(e);for(;s<=t&&this.isDisabled(s);)s=$(s,1);return s>t?null:s}getLastActiveISO(e=this.input){let s=this.getLastVisibleISO(e);const t=this.getFirstVisibleISO();for(;s>=t&&this.isDisabled(s);)s=$(s,-1);return s<t?null:s}monthTitle(e){return new Intl.DateTimeFormat(W(this.input.locale),{month:"long",year:"numeric"}).format(new Date(e.getUTCFullYear(),e.getUTCMonth()))}prevMonth(e){if(this.state.disableBefore&&this.getFirstVisibleISO()<=this.state.disableBefore)return!1;this.state.offset--;let s=this.state.tabindexISO;const t=this.getLastActiveISO();return t&&this.state.tabindexISO>t&&(s=this.state.tabindexISO=t),e&&this.setTabindexAndFocus(s),this.emit("month-change",{iso:d(this.getMonthDate(this.state.offset))}),!0}nextMonth(e){if(this.state.disableAfter&&this.getLastVisibleISO()>=this.state.disableAfter)return!1;this.state.offset++;let s=this.state.tabindexISO;const t=this.getFirstActiveISO();return t&&this.state.tabindexISO<t&&(s=this.state.tabindexISO=t),e&&this.setTabindexAndFocus(s),this.emit("month-change",{iso:d(this.getMonthDate(this.state.offset+(this.input.numMonths||1)))}),!0}setTabindexAndFocus(e){this.state.tabindexISO=e,setTimeout(()=>{var s;return(s=this.getEl(e))==null?void 0:s.focus()})}calculateRangeDisplay(e=this.input){if(e.selected&&e.range){let s,t;Array.isArray(e.selected)?[s,t]=e.selected:this.state.focusISO&&(s=e.selected,t=this.state.focusISO),s&&t?s<t?(this.state.rangeStart=s,this.state.rangeEnd=t):(this.state.rangeStart=t,this.state.rangeEnd=s):this.state.rangeStart=this.state.rangeEnd=null}}isInRange(e){return!(!this.state.rangeStart||!this.state.rangeEnd||e<this.state.rangeStart||e>this.state.rangeEnd)}}const E="uB4h6qrc",I=le(E),Oe=I;re.r(E,()=>I);const te=ce;I._=ne(function(i,e,s,t,a,f){const{numMonths:o=1,getA11yShowMonthText:c=b=>`Show ${b}`,a11ySelectedText:Y="selected",a11yRangeStartText:p="start of range",a11yInRangeText:R="in range",a11yRangeEndText:P="end of range",a11yTodayText:K="today",a11yDisabledText:j="inactive",a11ySeparator:z=" - ",navigable:se,selected:O,interactive:ae,linkBuilder:q}=i;var H=[...Array(o)].map((b,r)=>t.getMonthDate(a.offset+r));if(e.be("div",{class:"calendar"},"0",t,null,1),se){e.be("div",{class:"calendar__header"},"1",t,null,1),e.be("div",{class:"calendar__header--inner"},"2",t,null,1);{k(Z,{transparent:!0,size:"small",disabled:a.disableBefore&&t.getFirstVisibleISO()<=a.disableBefore,ariaLabel:c(t.monthTitle(t.getMonthDate(a.offset-1))),renderBody:r=>{k(de,{},r,s,"4")}},e,s,"3",[["click","prevMonth",!1,[!1]]]);let b=0;for(const r of H||[]){const h=`[${b++}]`;e.be("h3",null,"5"+h,t,null,0),e.t(t.monthTitle(r),t),e.ee()}k(Z,{transparent:!0,size:"small",disabled:a.disableAfter&&t.getLastVisibleISO()>=a.disableAfter,ariaLabel:c(t.monthTitle(t.getMonthDate(a.offset+o))),renderBody:r=>{k(fe,{},r,s,"7")}},e,s,"6",[["click","nextMonth",!1,[!1]]])}e.ee(),e.ee()}e.be("div",{class:"calendar__body"},"8",t,null,1);{let b=0;for(const r of H||[]){const h=`[${b++}]`;e.be("div",{class:"calendar__month"},"9"+h,t,null,1),e.be("table",null,"10"+h,t,null,0,{onkeydown:s.d("keydown","onKeyDown",!1)}),e.be("caption",null,"11"+h,t,null,0),e.t(t.monthTitle(r),t),e.ee(),e.be("thead",null,"12"+h,t,null,0),e.be("tr",null,"13"+h,t,null,0);{let L=0;for(const g of a.weekdayLabels||[]){const u=`[${L+++h}]`;e.be("th",null,"14"+u,t,null,0),e.t(g,t),e.ee()}}e.ee(),e.ee(),e.be("tbody",null,"15"+h,t,null,0);var A=(r.getUTCDay()-a.firstDayOfWeek+7)%7,N=r.getUTCFullYear(),G=r.getUTCMonth(),w=new Date(N,G+1,0).getDate();for(let L=(Math.floor((A+w)/7)-0)/1,g=0;g<=L;g++){const u=0+g*1,V=`[${u+h}]`;e.be("tr",null,"16"+V,t,null,0);var v=u*7-A+1,x=v+6;u===0&&A!==0?(e.e("td",{colspan:A},"17"+V,t,0,0),v=1):x>w&&(x=w);for(let ie=(x-v)/1,C=0;C<=ie;C++){const S=v+C*1,_=`[${S+V}]`;var l=d(new Date(Date.UTC(N,G,S))),T=l===a.todayISO,F=Array.isArray(O)?O.some(U=>U===l):O&&O===l,m=l===a.rangeStart,J=t.isInRange(l),M=l===a.rangeEnd,y=t.isDisabled(l),n=[""];if(Y&&F&&n.push(Y),p&&m&&n.push(p),R&&!m&&!M&&J&&n.push(R),P&&M&&n.push(P),e.be("td",{class:X({"calendar__cell--selected":F,"calendar__range--start":m,calendar__range:J,"calendar__range--end":M})},"18"+_,t,null,1),ae)e.be("button",{disabled:y,"aria-label":n.length>1&&`${S}${n.join(z)}`,tabindex:a.tabindexISO!==l&&-1,"aria-current":T&&"date","aria-pressed":F&&"true"},`@${l}`,t,null,0,{onclick:s.d("click","onDaySelect",!1,[l]),onfocus:s.d("focus","onDayFocus",!1,[l]),onmouseover:s.d("mouseover","onDayFocus",!1,[l]),onblur:s.d("blur","onDayBlur",!1),onmouseout:s.d("mouseout","onDayBlur",!1)}),e.t(S,t),e.ee();else{K&&T&&n.push(K),j&&y&&n.push(j);var Q=!y&&q&&q(l);const U=Q?"a":"span";e.be(U,{class:X({"calendar__cell--disabled":y,"calendar__cell--current":T}),href:Q},"19"+_,t,null,0),e.t(S,t),n.length>1&&(e.be("span",{class:"clipped"},"20"+_,t,null,1),e.t(n.join(z),t),e.ee()),e.ee()}e.ee()}e.ee()}e.ee(),e.ee(),e.ee()}}e.ee(),e.ee()},{t:E},te);I.Component=he(te,I._);export{Oe as _,B as d,d as t};
